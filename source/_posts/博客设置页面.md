---
title: åšå®¢è®¾ç½®é¡µé¢
author: Nothing2say
date: 2023-08-03 10:38:59
tags: 
    - åšå®¢
categories: 
    - 2023å¹´8æœˆæ—¥å¿—
---
è¿™æ˜¯ä¸€ä¸ªèµ·å§‹é¡µé¢çš„ä»‹ç»ï¼Œä¸»è¦åŒ…å«åšå®¢ä¸»é¢˜é¡µé¢çš„è®¾ç½®ã€åšå®¢çš„åŠŸèƒ½å±•ç¤ºä»¥åŠå¯¹åšå®¢å†æ¬¡ä¿®æ”¹çš„æ—¥å¿—è®°å½•ã€‚
## é”™è¯¯ä¿®æ”¹
### é’ˆå¯¹algoliaèŠå¤©æ¡†åŠŸèƒ½çš„ä¿®æ”¹
å½“ä¸éœ€è¦algoliaåŠŸèƒ½æ—¶ï¼Œhexoåœ¨æ„å»ºé¡µé¢æ—¶å‡ºç°ç›¸å…³æŠ¥é”™ï¼š
``` bash
TypeError: E:\Blog\Hexo\themes\Fan\layout\includes\config.pug:1
  > 1| -
    2|   var algolia = 'undefined';
    3|   var env = process.env;
    4|   if (theme.algolia_search.enable) {

Cannot read properties of undefined (reading 'valine')
    at eval (eval at wrap (E:\Blog\Hexo\node_modules\hexo-renderer-pug\node_module
s\pug-runtime\wrap.js:6:10), <anonymous>:198:38)
    at template (eval at wrap (E:\Blog\Hexo\node_modules\hexo-renderer-pug\node_mo
dules\pug-runtime\wrap.js:6:10), <anonymous>:1371:7)
    at _View._compiled (E:\Blog\Hexo\node_modules\hexo\lib\theme\view.js:136:50)
    at _View.render (E:\Blog\Hexo\node_modules\hexo\lib\theme\view.js:39:17)
    at E:\Blog\Hexo\node_modules\hexo\lib\hexo\index.js:64:21
    at tryCatcher (E:\Blog\Hexo\node_modules\bluebird\js\release\util.js:16:23)
    at E:\Blog\Hexo\node_modules\bluebird\js\release\method.js:15:34
    at RouteStream._read (E:\Blog\Hexo\node_modules\hexo\lib\hexo\router.js:47:5)
    at Readable.read (node:internal/streams/readable:496:12)
    at resume_ (node:internal/streams/readable:999:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
```
æ¨æµ‹åŸå› å’Œconfig.pugæ–‡ä»¶ä¸­çš„æ­¤æ®µä»£ç æœ‰å…³ï¼Œæ•…è¿›è¡Œæ³¨é‡Šã€‚
``` bash
  //- var algolia = 'undefined';
  //- var env = process.env;
  //- if (theme.algolia_search.enable) {
  //-   algolia = JSON.stringify({
  //-     appId: env.ALGOLIA_APP_ID || config.algolia.appId || config.algolia.applicationID,
  //-     apiKey: env.ALGOLIA_API_KEY || config.algolia.apiKey,
  //-     indexName: env.ALGOLIA_INDEX_NAME || config.algolia.indexName,
  //-     hits: theme.algolia_search.hits,
  //-     // search languages
  //-     languages: {
  //-       input_placeholder: _p("algolia_search.input_placeholder"),
  //-       hits_empty: _p("algolia_search.hits_empty"),
  //-       hits_stats: _p("algolia_search.hits_stats")
  //-     }
  //-   })
  //- }
```
é¡µé¢æ­£å¸¸æ˜¾ç¤ºäº†ï¼š
{% asset_img image.png æ˜¾ç¤ºé¡µé¢ %}

åœ¨æ ¹æ®<https://lanta.bangumi.cyou/2022/03/12/hexo-install-algolia/>çš„æ–¹æ³•æ³¨å†Œalgoliaè´¦æˆ·ï¼Œå¹¶é…ç½®å¥½æœç´¢åï¼Œå³å¯è¿›è¡Œæœç´¢
{% asset_img image_1.png æ˜¾ç¤ºæœç´¢é¡µé¢ %}
æ¯æ¬¡å†™å®Œæ–°æ–‡ç« åï¼Œè®°å¾—å†æ¬¡æ›´æ–°algoliaçš„ç´¢å¼•åº“:
``` bash
$ hexo algolia
```
### é’ˆå¯¹å¼€å§‹å’Œåˆ·æ–°æ—¶çš„é¡µé¢æ ‡é¢˜è®¾ç½®ï¼š
åœ¨/theme/ä¸»é¢˜/source/js/utils.jsä¸­å¯ä»¥ä¿®æ”¹ï¼Œå…±æœ‰ä¸¤ä¸ªè®¾ç½®ï¼ˆå¯æ·»åŠ ï¼‰ï¼š
ä¸€ä¸ªæ˜¯å®æ—¶æ—¶é—´çš„è·å–ï¼š
``` bash
/**
 * @description è·å–å®æ—¶æ—¶é—´ï¼Œå†™å…¥ id ä¸º now-time çš„æ ‡ç­¾ä¸­
 */
(function () {
    const divTime = document.getElementById('now-time');

    function getTime() {
        let time = new Date();
        let hour = time.getHours() < 10 ? '0' + time.getHours() : time.getHours();
        let minute = time.getMinutes() < 10 ? '0' + time.getMinutes() : time.getMinutes();
        let second = time.getSeconds() < 10 ? '0' + time.getSeconds() : time.getSeconds();
        divTime.innerText = hour + ':' + minute + ':' + second;
    }

    getTime();
    setInterval(function () {
        getTime();
    }, 1000);
}());
```
ä¸€ä¸ªæ˜¯é¡µé¢titleçš„æ›´æ”¹ï¼š
``` bash
/**
 * @description åˆ¤æ–­å½“å‰é¡µé¢æ˜¯å¦ä¸ºæ´»åŠ¨é¡µ
 */
(function () {
    // ç½‘é¡µå½“å‰çŠ¶æ€åˆ¤æ–­
    let state, visibilityChange, status, doc = document;
    if (typeof document.hidden !== 'undefined') {
        visibilityChange = 'visibilitychange';
        state = 'visibilityState';
    } else if (typeof document.mozHidden !== 'undefined') {
        visibilityChange = 'mozvisibilitychange';
        state = 'mozVisibilityState';
    } else if (typeof document.msHidden !== 'undefined') {
        visibilityChange = 'msvisibilitychange';
        state = 'msVisibilityState';
    } else if (typeof document.webkitHidden !== 'undefined') {
        visibilityChange = 'webkitvisibilitychange';
        state = 'webkitVisibilityState';
    }
    let docText = doc.title;
    // æ·»åŠ ç›‘å¬å™¨ï¼Œåœ¨titleé‡Œæ˜¾ç¤ºçŠ¶æ€å˜åŒ–
    doc.addEventListener(visibilityChange, function () {
        if (doc[state] === 'visible') {
            doc.title = 'æ¬¢è¿å›æ¥ï¼d(`ï½¥âˆ€ï½¥)b ğŸ‘';
            status = setTimeout(() => {
                doc.title = docText;
            }, 1000);
        } else {
            doc.title = 'è—èµ·æ¥äº†d(`x_x)b';
            if (status) {
                clearTimeout(status);
            }
        }
    }, false);
    // åˆå§‹åŒ–é¡µé¢çŠ¶æ€
    // doc.title = 'Nothing2sayçš„åšå®¢';
}());
```